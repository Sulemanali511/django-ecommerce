{% extends "base.html" %}
{% load i18n static %}

{% block head_title %}{% trans "place the order" %} {% endblock head_title %}

{% block carousel %}{% endblock carousel %}

{% block content %}
    <main class="py-4">
        <div class="container">
            <div class="row shadow-none justify-content-center">
                <!-- resume card -->
                <aside class="col-md-3 order-md-2 mb-4">
                    <!-- Heading -->
                    <h4 class="d-flex justify-content-between align-items-center mb-3">
                        <span class="text-muted">
                            {% trans "your order" %}
                            <small class="font-weight-bold">
                                ({% with total_items=panier|length %}
                                    {% if panier|length > 0  %}
                                        {{ total_items }}
                                    {% else %}
                                        0
                                    {% endif %}
                                    {% trans "article" %}{{ total_items|pluralize }}
                                {% endwith %} )
                            </small>
                        </span>
                    </h4><!-- ./Heading -->

                    <!-- Cart -->
                    <ul class="list-group rounded-sm mb-3">
                        {% for item in panier %}
                            <li class="list-group-item d-flex justify-content-between lh-condensed">
                                <div>
                                    <h6 class="my-0 font-weight-bold text-capitalize small">
                                        {{ item.produit.name|safe }}
                                    </h6>
                                    <small class="text-success font-weight-bold text-uppercase">
                                        {{ item.prix_total|floatformat:0|safe }} fcfa
                                    </small><br>
                                    <small class="text-muted">
                                        {% trans "Quantity" %}:
                                        <strong class="font-weight-bold">{{ item.quantite|safe }}</strong>
                                    </small>
                                </div>
                                <span>
                                    <img src="{% if item.produit.image %}{{ item.produit.image.url }} {% else %}{% static "img/cart.png" %}{% endif %}" alt="{{ item.produit.name|safe}}" width="70" class="float-right">
                                </span>
                            </li>
                        {% endfor %}
                        {% if panier.coupon %}
                            <li class="list-group-item d-flex justify-content-between bg-light">
                                {% with code=panier.coupon.code discount=panier.coupon.discount %}
                                    <div class="text-success">
                                        <h6 class="my-0">{% trans "Promo code" %}</h6>
                                        <small>"{{ code|safe }}"</small>
                                    </div>
                                    <span class="text-success">-{{ panier.get_discount|floatformat:0|safe }}</span>
                                {% endwith %}
                            </li>
                        {% endif %}
                        <li class="list-group-item d-flex justify-content-between">
                            <span class="text-uppercase font-weight-bold">
                                {% trans "total" %} (frcfa)
                            </span>
                            <span class="h5 text-uppercase font-weight-bold text-success">
                                {{ panier.get_cout_total_apres_discount|floatformat:0|safe }}
                            </span>
                        </li>
                    </ul><!-- ./Cart -->

                    <div class="card shadow-none p-2 text-center text-uppercase font-weight-bold">
                        <a href="{% url "panier:detail_panier" %}" class="text-success">
                        {% trans "back to shopping cart" %}</a>
                    </div>
                </aside>

                <!-- checkout form -->
                <div class="col-md-7 order-md-1">
                    <h4 class="mb-3 text-uppercase">
                        <span class="text-muted small">
                        {% trans "finalization of the order" %}</span>
                    </h5>

                    <div class="card shadow-sm border">
                        <div class="card-header text-uppercase bg-transparent">
                            {% trans "address" %}
                        </div>
                        <form method="post" class="card-body needs-validation" novalidate="">
                            <!-- Grid row -->
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="formulaire.last_name.id_for_label">
                                        {{ formulaire.last_name.label_tag }}
                                    </label>
                                </div>
                            </div>
                            <div class="row">
                                {% for champs in formulaire %}
                                    <div class="col-md-6 mb-3">
                                        <div class="md-form form-group">
                                            {{ champs.errors }}
                                            {{ champs.label_tag }}
                                            {{ champs }}
                                        </div>
                                    </div>
                                {% endfor %}
                                <hr class="mb-4">
                                <button class="btn btn-primary btn-sm btn-block" type="submit">
                                {% trans "confirm" %}</button>
                                {% csrf_token %}
                            </div>
                        </form>
                    </div>
                </div><!--./Grid column-->
            </div>
        </div>
    </main>
{% endblock content %}
